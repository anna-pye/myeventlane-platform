# Cursor Rules — MyEventLane Platform

## Project
This repository is **MyEventLane**, a Drupal 11 event and ticketing platform running on **DDEV (Docker)** on macOS.

Cursor operates inside a real, active repository.
The filesystem and codebase are authoritative.

---

## Stack and Layout
- Drupal 11, Composer-based
- Docroot: `web/`
- Custom modules: `web/modules/custom/*`
- Custom theme: `web/themes/custom/myeventlane_theme/`
- DDEV CLI is required for all PHP, Composer, Drush, and Node commands

---

## Commands (DDEV only)
Cursor MUST use:

- `ddev composer <args>`
- `ddev drush <args>`
- `ddev exec vendor/bin/phpcs`
- `ddev exec vendor/bin/phpstan`
- `ddev exec npm run dev`
- `ddev exec npm run build`

Cursor MUST NOT suggest non-DDEV commands.

---

## Coding Standards
- Follow Drupal coding standards (Drupal + DrupalPractice)
- Use dependency injection and services
- Avoid `\Drupal::service()` and static calls in new code
- Keep namespaces and `use` statements clean
- Twig must remain accessible and mobile-first

---

## MyEventLane Architecture Rules
Respect existing module boundaries:

- `myeventlane_core` — shared services and helpers
- `myeventlane_rsvp` — RSVP logic and public forms
- `myeventlane_tickets` — ticketing, TicketMatrixForm, stock logic
- `myeventlane_vendor_dashboard` — vendor dashboard, CSV export, analytics
- `myeventlane_checkout_*` — checkout panes and attendee information

Do NOT move logic between modules unless explicitly instructed.

For new features:
- Prefer services, plugins, and hooks
- Do NOT add business logic directly to controllers unless unavoidable

---

## Safety and Immutability
Cursor MUST NOT edit:

- `web/core/`
- `web/modules/contrib/`
- `vendor/`
- `.ddev/`

Cursor MUST NOT modify:

- `composer.json`
- `composer.lock`

Unless explicitly instructed.

Cursor MUST NOT invent:
- New database tables
- New entities
- New schema

Without a clear migration plan and explicit approval.

---

## Editing Rules (Strict)
- When modifying a file, output the **entire file**, not snippets
- Preserve existing docblocks, annotations, service IDs, and routes unless instructed otherwise
- Assume Drupal 11 APIs and handle deprecations carefully

---

## Termination and Clarification Rules (Critical)
Cursor MUST STOP and ask **one clear clarification question** if:

- Requirements are ambiguous
- A change would alter existing working behaviour
- A file or module choice is unclear
- A request conflicts with these rules

Cursor MUST NOT:
- Guess intent
- Simplify scope
- Refactor for “cleanliness”
- Introduce new patterns without instruction
- Continue once blocked by ambiguity

---

## Execution Responsibility Boundaries
- Cursor executes instructions
- Cursor applies code verbatim when given full files
- Cursor reports real compiler, runtime, or Drupal errors only

Cursor is NOT responsible for:
- Architecture invention
- Product decisions
- UX redesign unless explicitly requested

---

## Testing and Verification
After meaningful changes, suggest only:

- `ddev drush cr`
- `ddev exec vendor/bin/phpcs web/modules/custom`
- `ddev exec vendor/bin/phpstan web/modules/custom`
- Relevant existing tests (if present)

Do NOT invent new tests unless asked.

---

## External Architecture Authority
“MyEventLane Studio” documentation and user-provided ChatGPT plans are the architectural source of truth.

If a conflict exists, Cursor MUST STOP and ask.

---

## Canonical Repository
Local path:
- `/Users/anna/myeventlane`

Remote:
- `git@github.com:anna-pye/myeventlane-platform.git`

Default branch:
- `main`

---

## Absolute Git Restrictions
Cursor MUST NOT:

- Create or use Git worktrees
- Check out branches inside `~/.cursor/worktrees/`
- Lock or check out `main` outside `/Users/anna/myeventlane`
- Create detached HEAD states
- Perform force merges
- Run `git reset --hard` without explicit confirmation

If any instruction would violate these rules:
**STOP and ask the user.**

---

## Required Git Workflow
- All commands must run from `/Users/anna/myeventlane`
- All development occurs on `feature/*` branches
- `main` is updated **only** via GitHub Pull Requests
- Prefer PR merges over local merges

---

## Mandatory Safety Checks
Before suggesting Git commands, Cursor MUST verify: