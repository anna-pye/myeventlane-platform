// ==========================================================================
// Button Components
// ==========================================================================
// Full button system with variants, sizes, and states.

@use 'sass:color';
@use '../tokens/colors';
@use '../tokens/typography';
@use '../tokens/spacing';
@use '../tokens/radii';
@use '../tokens/shadows';

// ---------------------------------------------------------------------------
// Base Button
// ---------------------------------------------------------------------------

.mel-btn {
  // Display
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: spacing.mel-space(2);

  // Sizing (default: medium)
  padding: spacing.mel-space(2) spacing.mel-space(4);
  min-height: 44px; // Touch-friendly minimum

  // Typography
  font-family: typography.$mel-font-family;
  font-size: typography.mel-font-size(base);
  font-weight: typography.$mel-font-semibold;
  line-height: 1;
  text-decoration: none;
  white-space: nowrap;

  // Appearance
  border: 2px solid transparent;
  border-radius: radii.$mel-radius-md;
  cursor: pointer;
  transition:
    transform var(--mel-motion-fast) var(--mel-ease-out),
    box-shadow var(--mel-motion-fast) var(--mel-ease-out),
    background-color var(--mel-motion-fast) var(--mel-ease-out),
    border-color var(--mel-motion-fast) var(--mel-ease-out),
    color var(--mel-motion-fast) var(--mel-ease-out);

  // Focus
  &:focus {
    outline: none;
  }

  &:focus-visible {
    @include colors.mel-focus-ring;
  }

  // Disabled
  &:disabled,
  &.is-disabled {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
  }
}

// ---------------------------------------------------------------------------
// Button Variants
// ---------------------------------------------------------------------------

// Primary (Coral) - Main CTAs
.mel-btn-primary {
  background-color: colors.$mel-color-primary;
  color: colors.$mel-color-text-inverse;
  border-radius: radii.$mel-radius-full; // Pill shape
  font-weight: typography.$mel-font-bold;
  letter-spacing: 0.01em;

  @media (hover: hover) and (pointer: fine) {
    &:hover {
      background-color: colors.$mel-color-primary-hover;
      transform: translateY(-1px);
      box-shadow: 0 4px 14px rgba(colors.$mel-color-primary, 0.30);
    }
  }

  &:active {
    background-color: colors.$mel-color-primary-active;
  }

  &:focus-visible {
    @include colors.mel-focus-ring;
  }
}

// Primary button variant for RSVP/Ticket buttons (WCAG compliant)
.button--rsvp,
.button--ticket {
  color: colors.$mel-color-text-inverse;
  background-color: colors.$mel-color-secondary-active;
  transition:
    transform var(--mel-motion-fast) var(--mel-ease-out),
    box-shadow var(--mel-motion-fast) var(--mel-ease-out);

  @media (hover: hover) and (pointer: fine) {
    &:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 18px rgba(colors.$mel-color-secondary-active, 0.35);
    }
  }

  &:focus-visible {
    @include colors.mel-focus-ring;
  }
}

// CTA Button Hierarchy
.button--primary {
  background: colors.$mel-color-primary;
  color: colors.$mel-color-text-inverse;
  font-weight: typography.$mel-font-bold;
  letter-spacing: 0.01em;
  transition:
    transform var(--mel-motion-fast) var(--mel-ease-out),
    box-shadow var(--mel-motion-fast) var(--mel-ease-out);

  @media (hover: hover) and (pointer: fine) {
    &:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 14px rgba(colors.$mel-color-primary, 0.30);
    }
  }

  &:focus-visible {
    @include colors.mel-focus-ring;
  }
}

.button--secondary {
  background: transparent;
  border: 2px solid colors.$mel-color-primary;
  color: colors.$mel-color-primary;
  border-radius: radii.$mel-radius-full; // Pill shape
  font-weight: typography.$mel-font-bold;

  @media (hover: hover) and (pointer: fine) {
    &:hover {
      background: rgba(colors.$mel-color-primary, 0.06);
      border-color: colors.$mel-color-primary;
    }
  }

  &:active {
    background: rgba(colors.$mel-color-primary, 0.10);
  }

  &:focus-visible {
    @include colors.mel-focus-ring;
  }
}

// Secondary (Outline) - Secondary actions
.mel-btn-secondary {
  background-color: transparent;
  border: 2px solid colors.$mel-color-primary;
  color: colors.$mel-color-primary;
  border-radius: radii.$mel-radius-full; // Pill shape
  font-weight: typography.$mel-font-bold;

  @media (hover: hover) and (pointer: fine) {
    &:hover {
      background-color: rgba(colors.$mel-color-primary, 0.05);
    }
  }

  &:active {
    background-color: rgba(colors.$mel-color-primary, 0.1);
  }
}

// Accent (Yellow) - Highlights, special actions
.mel-btn-accent {
  background-color: colors.$mel-color-accent;
  color: colors.$mel-color-text;

  &:hover {
    background-color: color.adjust(colors.$mel-color-accent, $lightness: -8%);
  }

  &:active {
    background-color: color.adjust(colors.$mel-color-accent, $lightness: -12%);
  }
}

// Create Event CTA - prominent header button
.mel-btn-create-event {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-weight: 700;

  svg {
    flex-shrink: 0;
  }
}

// Ghost - Subtle, outlined
.mel-btn-ghost {
  background-color: transparent;
  color: colors.$mel-color-text;
  border-color: colors.$mel-color-border-strong;

  @media (hover: hover) and (pointer: fine) {
    &:hover {
      background-color: colors.$mel-color-bg;
      border-color: colors.$mel-color-text-muted;
    }
  }

  &:active {
    background-color: colors.$mel-color-surface-alt;
  }
}

// Text - No background or border
.mel-btn-text {
  background-color: transparent;
  color: colors.$mel-color-primary;
  padding-left: spacing.mel-space(2);
  padding-right: spacing.mel-space(2);

  @media (hover: hover) and (pointer: fine) {
    &:hover {
      color: colors.$mel-color-primary-hover;
      text-decoration: underline;
    }
  }

  &:focus-visible {
    @include colors.mel-focus-ring;
  }
}

// Danger - Destructive actions
.mel-btn-danger {
  background-color: colors.$mel-color-error;
  color: colors.$mel-color-text-inverse;

  &:hover {
    background-color: color.adjust(colors.$mel-color-error, $lightness: -10%);
  }
}

// Success - Positive confirmations
.mel-btn-success {
  background-color: colors.$mel-color-success;
  color: colors.$mel-color-text-inverse;

  &:hover {
    background-color: color.adjust(colors.$mel-color-success, $lightness: -10%);
  }
}

// ---------------------------------------------------------------------------
// Button Sizes
// ---------------------------------------------------------------------------

.mel-btn-sm {
  padding: spacing.mel-space(1) spacing.mel-space(3);
  min-height: 36px;
  font-size: typography.mel-font-size(sm);
  border-radius: radii.$mel-radius-sm;
}

.mel-btn-lg {
  padding: spacing.mel-space(3) spacing.mel-space(6);
  min-height: 52px;
  font-size: typography.mel-font-size(md);
  border-radius: radii.$mel-radius-lg;
}

// ---------------------------------------------------------------------------
// Button Modifiers
// ---------------------------------------------------------------------------

// Full width
.mel-btn-block {
  display: flex;
  width: 100%;
}

// Pill shape
.mel-btn-pill {
  border-radius: radii.$mel-radius-full;
}

// Icon only (square)
.mel-btn-icon {
  padding: spacing.mel-space(2);
  min-width: 44px;
}

// ---------------------------------------------------------------------------
// Button Group
// ---------------------------------------------------------------------------

.mel-btn-group {
  display: inline-flex;
  gap: spacing.mel-space(2);
}

.mel-btn-group-attached {
  display: inline-flex;

  .mel-btn {
    border-radius: 0;

    &:first-child {
      border-radius: radii.$mel-radius-md 0 0 radii.$mel-radius-md;
    }

    &:last-child {
      border-radius: 0 radii.$mel-radius-md radii.$mel-radius-md 0;
    }

    &:not(:last-child) {
      border-right-width: 1px;
    }
  }
}

// ---------------------------------------------------------------------------
// Button with Icon
// ---------------------------------------------------------------------------

.mel-btn-icon-left {
  svg, .mel-icon {
    margin-right: spacing.mel-space(1);
  }
}

.mel-btn-icon-right {
  svg, .mel-icon {
    margin-left: spacing.mel-space(1);
  }
}

// ---------------------------------------------------------------------------
// Mobile-First Button Variants (CSS Variables)
// ---------------------------------------------------------------------------
// Additional button classes using CSS custom properties for consistency.

.mel-btn--primary {
  // Default primary = brand lavender/purple.
  background: var(--mel-primary);
  color: colors.$mel-color-text-inverse;
  border-radius: radii.$mel-radius-full; // Pill shape
  font-weight: typography.$mel-font-bold;

  @media (hover: hover) and (pointer: fine) {
    &:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 18px rgba(colors.$mel-color-primary, 0.35);
    }
  }

  &:focus-visible {
    @include colors.mel-focus-ring;
  }
}

// CTA (Coral) - conversion moments (Create, Boost, Tickets, Checkout).
.mel-btn--cta {
  background: var(--mel-accent);
  color: colors.$mel-color-text-inverse;
  border-radius: radii.$mel-radius-full; // Pill shape
  font-weight: typography.$mel-font-bold;

  @media (hover: hover) and (pointer: fine) {
    &:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 18px rgba(colors.$mel-color-secondary, 0.35);
    }
  }

  &:focus-visible {
    @include colors.mel-focus-ring;
  }
}

.mel-btn--disabled {
  background: rgba(41, 50, 65, 0.10);
  color: var(--mel-muted);
  cursor: not-allowed;
  pointer-events: none;
}

// Ensure all interactive elements meet 44px tap target requirement
a.mel-btn,
button.mel-btn,
.mel-btn[role="button"] {
  min-height: 44px;
  min-width: 44px; // For icon-only buttons
}

// Pills and icon buttons
.mel-btn-pill,
.mel-btn-icon {
  min-height: 44px;
  min-width: 44px;
}
