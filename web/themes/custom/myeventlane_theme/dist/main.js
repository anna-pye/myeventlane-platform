let t={checkbox:null,toggle:null,mobileNav:null,closeBtn:null,overlay:null,initialized:!1};function y(){if(t.initialized)return;const l=document.querySelector("#mel-nav-toggle-checkbox");if(t.toggle=document.querySelector(".mel-nav-toggle"),t.mobileNav=document.querySelector(".mel-nav-mobile-wrapper"),t.closeBtn=document.querySelector(".mel-nav-mobile-close"),t.overlay=document.querySelector(".mel-nav-overlay"),!l||!t.toggle||!t.mobileNav){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",y):setTimeout(y,100);return}t.checkbox=l,t.initialized=!0,t.checkbox.addEventListener("change",function(){if(t.checkbox.checked){a=document.activeElement,t.mobileNav.classList.add("is-open"),t.overlay&&t.overlay.classList.add("is-visible"),t.toggle.setAttribute("aria-expanded","true"),t.mobileNav.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden";const e=t.mobileNav.querySelector("a, button");e&&setTimeout(()=>e.focus(),100),document.addEventListener("keydown",r)}else t.mobileNav.classList.remove("is-open"),t.overlay&&t.overlay.classList.remove("is-visible"),t.toggle.setAttribute("aria-expanded","false"),t.mobileNav.setAttribute("aria-hidden","true"),document.body.style.overflow="",document.removeEventListener("keydown",r),a&&typeof a.focus=="function"?setTimeout(()=>a.focus(),100):t.toggle.focus()});const u=()=>{const e=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(", ");return Array.from(t.mobileNav.querySelectorAll(e))};let a=null;function r(e){if(!t.checkbox.checked)return;const n=u();if(n.length===0)return;const o=n[0],s=n[n.length-1];e.key==="Tab"&&(e.shiftKey?document.activeElement===o&&(e.preventDefault(),s.focus()):document.activeElement===s&&(e.preventDefault(),o.focus()))}function d(){t.checkbox.checked=!1,t.mobileNav.classList.remove("is-open"),t.overlay&&t.overlay.classList.remove("is-visible"),t.toggle.setAttribute("aria-expanded","false"),t.mobileNav.setAttribute("aria-hidden","true"),document.body.style.overflow="",document.removeEventListener("keydown",r),a&&typeof a.focus=="function"?setTimeout(()=>a.focus(),100):t.toggle.focus()}document.addEventListener("click",function(e){if(e.target.closest(".mel-nav-mobile-close")||e.target.closest("[data-nav-close]")){e.preventDefault(),e.stopPropagation(),d();return}if(e.target===t.overlay||e.target.classList.contains("mel-nav-overlay")){e.preventDefault(),e.stopPropagation(),d();return}},!0),document.addEventListener("keydown",function(e){e.key==="Escape"&&t.checkbox.checked&&d()});const i=window.matchMedia("(min-width: 768px)");i.addEventListener?i.addEventListener("change",function(e){e.matches&&t.checkbox.checked&&d()}):i.addListener(function(e){e.matches&&t.checkbox.checked&&d()})}(function(l){const u=new WeakMap;l.behaviors.eventFormConditionalFields={attach:function(a,r){const d=a.querySelector('form.node-event-form, form[id*="node-event-form"], .mel-event-form-wrapper form');if(!d)return;const i=['select[name="field_event_type[0][value]"]','select[data-booking-type-select="true"]','select[name*="field_event_type"][name*="value"]','.mel-form-content select[name*="field_event_type"]','.booking_config select[name*="field_event_type"]','select[name*="field_event_type"]'];let e=null;for(let c=0;c<i.length;c++)if(e=a.querySelector(i[c]),e){console.log("Event form: Found select with selector:",i[c]);break}if(!e){d&&console.warn("Event form: Could not find field_event_type select element");return}if(typeof l<"u"&&l.behaviors&&setTimeout(function(){if(typeof l.states<"u"&&l.states.trigger&&l.states.trigger(e,"change"),typeof jQuery<"u"&&jQuery(e).length)jQuery(e).trigger("change").trigger("input");else if(e){const c=new Event("change",{bubbles:!0,cancelable:!0}),f=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(c),e.dispatchEvent(f)}},300),u.has(e))return;const n=a.querySelector(".mel-booking-rsvp"),o=a.querySelector(".mel-booking-paid"),s=a.querySelector(".mel-booking-external");console.log("Event form: Containers found - RSVP:",!!n,"Paid:",!!o,"External:",!!s);const m=function(){const c=e.value;if(console.log("Event form: Fallback visibility check for value:",c),n){const f=window.getComputedStyle(n),v=f.display!=="none"&&f.visibility!=="hidden",b=c==="rsvp"||c==="both";b&&!v?(console.warn("Event form: Fallback - showing RSVP fields"),n.style.display="block",n.removeAttribute("data-force-hidden")):!b&&v&&!n.hasAttribute("data-conditional-fields-processed")&&(n.style.display="none",n.setAttribute("data-force-hidden","true"))}if(o){const f=window.getComputedStyle(o),v=f.display!=="none"&&f.visibility!=="hidden",b=c==="paid"||c==="both";b&&!v?(console.warn("Event form: Fallback - showing Paid fields"),o.style.display="block",o.removeAttribute("data-force-hidden")):!b&&v&&!o.hasAttribute("data-conditional-fields-processed")&&(o.style.display="none",o.setAttribute("data-force-hidden","true"))}if(s){const f=window.getComputedStyle(s),v=f.display!=="none"&&f.visibility!=="hidden",b=c==="external";b&&!v?(console.warn("Event form: Fallback - showing External fields"),s.style.display="block",s.removeAttribute("data-force-hidden")):!b&&v&&!s.hasAttribute("data-conditional-fields-processed")&&(s.style.display="none",s.setAttribute("data-force-hidden","true"))}};setTimeout(function(){n&&!n.hasAttribute("data-conditional-fields-processed")&&m(),o&&!o.hasAttribute("data-conditional-fields-processed")&&m(),s&&!s.hasAttribute("data-conditional-fields-processed")&&m()},500),e.addEventListener("change",function(){typeof l.states<"u"&&l.states.trigger&&l.states.trigger(e,"change"),setTimeout(function(){m()},150)});let h=null;(n||o||s)&&(h=setInterval(function(){e.value&&(n&&n.hasAttribute("data-force-hidden")&&!n.hasAttribute("data-conditional-fields-processed")||o&&o.hasAttribute("data-force-hidden")&&!o.hasAttribute("data-conditional-fields-processed")||s&&s.hasAttribute("data-force-hidden")&&!s.hasAttribute("data-conditional-fields-processed"))&&(console.warn("Event form: Conditional fields not working, using fallback"),m())},3e3),u.set(e,h))},detach:function(a,r,d){const i=['select[name="field_event_type[0][value]"]','select[name*="field_event_type"][name*="value"]','select[name*="field_event_type"]'];for(let e=0;e<i.length;e++){const n=a.querySelector(i[e]);if(n&&u.has(n)){const o=u.get(n);o&&(clearInterval(o),u.delete(n),console.log("Event form: Cleaned up interval for select element"));break}}}}})(Drupal);(function(l){function u(r){once("mel-card-image",".mel-event-card__image",r).forEach(function(i){const e=i.querySelector("img.mel-event-card__image-element, img");if(!e){i.classList.add("is-loaded");return}if(e.complete&&e.naturalHeight!==0){i.classList.add("is-loaded"),e.classList.add("is-loaded");return}e.addEventListener("load",function(){i.classList.add("is-loaded"),e.classList.add("is-loaded")},{once:!0}),e.addEventListener("error",function(){i.classList.add("is-loaded"),e.style.display="none";const n=i.querySelector(".mel-event-card__placeholder--fallback");n&&(n.style.display="flex")},{once:!0})})}function a(r){once("mel-carousel",".mel-featured-carousel",r).forEach(function(i){const e=i.querySelector(".mel-featured-carousel__track"),n=i.querySelector(".mel-featured-carousel__button--prev"),o=i.querySelector(".mel-featured-carousel__button--next");if(!e||!n||!o)return;const s=e.querySelector(".mel-featured-carousel__slide");if(!s)return;const m=s.offsetWidth+parseInt(getComputedStyle(e).gap,10)||16,c=window.matchMedia("(prefers-reduced-motion: reduce)").matches?"auto":"smooth";n.addEventListener("click",function(){e.scrollBy({left:-m,behavior:c})}),o.addEventListener("click",function(){e.scrollBy({left:m,behavior:c})})})}l.behaviors.melCardMedia={attach:function(r,d){u(r),a(r)}}})(Drupal);(function(){function l(u){y()}typeof Drupal<"u"&&Drupal.behaviors&&(Drupal.behaviors.myeventlaneTheme={attach:function(u,a){l()}}),document.readyState==="loading"?(document.addEventListener("DOMContentLoaded",function(){l()}),setTimeout(function(){l()},0)):l(),setTimeout(function(){l()},500)})();
