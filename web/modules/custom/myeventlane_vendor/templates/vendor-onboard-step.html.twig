{#
/**
 * @file
 * Template for vendor onboarding step pages.
 *
 * Uses render element 'form' so the element (form or controller render array)
 * is passed directly. This ensures form_build_id, form_token, form_id render
 * correctly in context (copied elements lose #name, placeholder replacement).
 *
 * Available: form (the element with #step_number, #step_title, etc., and
 * optionally form.form_build_id, form.form_token, form.form_id, form.step_content).
 */
#}
{% set step_number = form['#step_number'] ?? 1 %}
{% set total_steps = form['#total_steps'] ?? 5 %}
{% set step_title = form['#step_title'] ?? '' %}
{% set step_description = form['#step_description'] ?? null %}
{% set back_route = null %}
{% if step_number == 2 %}
  {% set back_route = 'myeventlane_vendor.onboard.account' %}
{% elseif step_number == 3 %}
  {% set back_route = 'myeventlane_vendor.onboard.profile' %}
{% elseif step_number == 4 %}
  {% set back_route = 'myeventlane_vendor.onboard.stripe' %}
{% elseif step_number == 5 %}
  {% set back_route = 'myeventlane_vendor.onboard.first_event' %}
{% elseif step_number == 6 %}
  {% set back_route = 'myeventlane_vendor.onboard.boost' %}
{% endif %}
<div class="mel-onboard-wrapper mel-onboard-wrapper--vendor">
  <div class="mel-container mel-container--onboard">

    {# Progress indicator #}
    <div class="mel-onboard-progress" role="progressbar" aria-valuenow="{{ step_number }}" aria-valuemin="1" aria-valuemax="{{ total_steps }}" aria-label="{{ 'Onboarding progress'|t }}">
      <div class="mel-onboard-progress-bar" style="width: {{ (step_number / total_steps * 100)|round }}%"></div>
      <div class="mel-onboard-progress-steps">
        {% for i in 1..total_steps %}
          <div class="mel-onboard-progress-step {{ i <= step_number ? 'mel-onboard-progress-step--active' : '' }} {{ i == step_number ? 'mel-onboard-progress-step--current' : '' }}">
            <span class="mel-onboard-progress-step-number">{{ i }}</span>
          </div>
        {% endfor %}
      </div>
    </div>

    {# Step header #}
    <div class="mel-onboard-header">
      <h1 class="mel-onboard-title">{{ step_title }}</h1>
      {% if step_description %}
        <p class="mel-onboard-description">{{ step_description }}</p>
      {% endif %}
    </div>

    {# Step content - render form children in context (form_build_id, form_token, form_id, step_content) or #content for controllers #}
    <div class="mel-onboard-content">
      {% if form.form_build_id is defined %}{{ form.form_build_id }}{% endif %}
      {% if form.form_token is defined %}{{ form.form_token }}{% endif %}
      {% if form.form_id is defined %}{{ form.form_id }}{% endif %}
      {{ form.step_content|default(form['#content']) }}
    </div>

    {# Navigation (if needed) #}
    {% if back_route %}
      <div class="mel-onboard-nav">
        <a href="{{ path(back_route) }}" class="mel-btn mel-btn-ghost">
          {{ 'Back'|t }}
        </a>
      </div>
    {% endif %}

  </div>
</div>
